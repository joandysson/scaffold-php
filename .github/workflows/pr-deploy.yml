name: Deploy on PR label

on:
  pull_request_target:
    types: [labeled]

permissions:
  contents: read

jobs:
  deploy:
    if: >-
      github.event.label.name == 'deploy' &&
      github.event.pull_request.state == 'open' &&
      github.event.pull_request.base.ref == 'main'
    uses: ./.github/workflows/main.yml
    with:
      run_setup_env: true
    secrets: inherit
